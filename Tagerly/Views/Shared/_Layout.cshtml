@using System.Security.Claims
<!doctype html>
<html lang="en" dir="ltr">

<head>
    <!-- Meta Tags -->
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Tagerly Store for Unique Handmade Products">
    <meta name="author" content="Tagerly">
    <meta name="keywords" content="Handmade Products, Gifts, Home Decor">

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="~/assets/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="~/assets/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="~/assets/favicon/favicon-16x16.png">

    <!-- Vendor CSS -->
    <link rel="stylesheet" href="~/assets/css/libs.bundle.css" />

    <!-- Main CSS -->
    <link rel="stylesheet" href="~/assets/css/theme.bundle.css" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">

    <title>Tagerly | Unique Handmade Products</title>

    <style>
        body {
            font-family: 'Tajawal', sans-serif;
        }

        .navbar-brand {
            font-weight: 700;
        }

        .dropdown-megamenu {
            right: 0 !important;
            left: auto !important;
        }

        .rtl-dropdown {
            text-align: right;
            direction: rtl;
        }

        .bg-primary {
            background-color: #8f7668 !important;
        }

        .text-primary {
            color: #8f7668 !important;
        }

        .footer-bg {
            background-color: rgb(165, 97, 42) !important;
        }

        /* Notification Styles - Improved Version */
        .notification-container {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 1100;
            width: 350px;
        }

        .alert-notification {
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
            opacity: 0;
            transform: translateY(-20px);
            animation: fadeIn 0.3s ease forwards;
        }

            .alert-notification.show {
                opacity: 1;
                transform: translateY(0);
            }

            .alert-notification .icon {
                font-size: 1.5rem;
                margin-right: 1rem;
            }

        .alert-success {
            background-color: #f6ffed;
            color: #52c41a;
            border-left-color: #52c41a;
        }

        .alert-danger {
            background-color: #fff2f0;
            color: #ff4d4f;
            border-left-color: #ff4d4f;
        }

        .alert-info {
            background-color: #e6f7ff;
            color: #1890ff;
            border-left-color: #1890ff;
        }

        .alert-warning {
            background-color: #fffbe6;
            color: #faad14;
            border-left-color: #faad14;
        }

        @@keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Responsive adjustments */
        @@media (max-width: 768px) {
            .notification-container {
                width: 90%;
                left: 5%;
                right: 5%;
                top: 70px;
            }
        }

        /* Delete Modal Specific Styles */
        .modal-danger .modal-header {
            background-color: #dc3545;
            color: white;
            border-bottom: none;
        }

        .modal-danger .alert {
            border-left: 4px solid #dc3545;
            background-color: rgba(248, 215, 218, 0.2);
        }

        .modal-danger .btn-danger {
            background-color: #dc3545;
            border-color: #dc3545;
            transition: all 0.3s;
        }

            .modal-danger .btn-danger:hover {
                background-color: #bb2d3b;
                border-color: #b02a37;
            }

        /* Theme color overrides */
        .bg-primary {
            background-color: rgb(165, 97, 42) !important;
        }

        .text-primary {
            color: rgb(165, 97, 42) !important;
        }

        .btn-primary {
            background-color: rgb(165, 97, 42);
            border-color: rgb(165, 97, 42);
        }

            .btn-primary:hover {
                background-color: rgb(145, 85, 37);
                border-color: rgb(145, 85, 37);
            }

        /* Badge color */
        .badge.bg-primary {
            background-color: #8f7668 !important;
        }

        /* Fix for RTL dropdown */
        .rtl-dropdown {
            text-align: left;
            direction: ltr;
        }
    </style>
</head>

<body>
    <div class="notification-container">
        @if (TempData["SuccessMessage"] != null)

        {
            <div class="alert-notification alert-success show">
                <i class="ri-checkbox-circle-fill icon"></i>
                <div>
                    <h6 class="mb-1">Success</h6>
                    <p class="mb-0 small">@TempData["SuccessMessage"]</p>
                </div>
                <button type="button" class="btn-close ms-auto" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        }

        @if (TempData["ErrorMessage"] != null)

        {
            <div class="alert-notification alert-danger show">
                <i class="ri-error-warning-fill icon"></i>
                <div>
                    <h6 class="mb-1">Error</h6>
                    <p class="mb-0 small">@TempData["ErrorMessage"]</p>
                </div>
                <button type="button" class="btn-close ms-auto" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        }

        @if (TempData["InfoMessage"] != null)

        {
            <div class="alert-notification alert-info show">
                <i class="ri-information-fill icon"></i>
                <div>
                    <h6 class="mb-1">Info</h6>
                    <p class="mb-0 small">@TempData["InfoMessage"]</p>
                </div>
                <button type="button" class="btn-close ms-auto" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        }

        @if (TempData["WarningMessage"] != null)

        {
            <div class="alert-notification alert-warning show">
                <i class="ri-alert-fill icon"></i>
                <div>
                    <h6 class="mb-1">Warning</h6>
                    <p class="mb-0 small">@TempData["WarningMessage"]</p>
                </div>
                <button type="button" class="btn-close ms-auto" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        }
    </div>

    <nav class="navbar navbar-expand-lg navbar-light bg-white sticky-top shadow-sm">
        <div class="container">
            <!-- Logo -->
            <a class="navbar-brand" href="/">
                <img src="~/assets/images/logo.png" alt="Tagerly" height="40">
            </a>

            <!-- Mobile Toggle Button -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
                <span class="navbar-toggler-icon"></span>
            </button>

            <!-- Main Navigation -->
            <div class="collapse navbar-collapse" id="navbarContent">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="productsDropdown" data-bs-toggle="dropdown">
                            Products
                        </a>
                        <div class="dropdown-menu dropdown-megamenu" aria-labelledby="productsDropdown">
                            <div class="container">
                                <div class="row">
                                    <div class="col-md-4">
                                        <h6 class="dropdown-header">Handmade Products</h6>
                                        <a class="dropdown-item" href="#">Personal Care</a>
                                        <a class="dropdown-item" href="#">Home Decor</a>
                                        <a class="dropdown-item" href="#">Gifts</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">About Us</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Blog</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Contact</a>
                    </li>
                </ul>

                <!-- User Actions -->
                <div class="d-flex align-items-center">
                    @if (User.Identity.IsAuthenticated)

                    {
                        <div class="dropdown me-3">
                            <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="ri-user-line ri-lg me-1"></i>
                                <span class="d-none d-lg-inline">@(User.FindFirst(ClaimTypes.GivenName)?.Value ?? User.Identity.Name)</span>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                                <li><a class="dropdown-item" asp-controller="User" asp-action="UpdateProfile" asp-route-id="@ViewData["UserId"]">My Profile</a></li>
                                @if (User.IsInRole("Seller"))

                                {
                                    <li><a class="dropdown-item" asp-controller="Product" asp-action="Index">My Products</a></li>
                                }
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" asp-controller="Account" asp-action="Logout">Logout</a></li>
                            </ul>
                        </div>
                    }

                    else

                    {
                        <div class="d-flex">
                            <a asp-controller="Account" asp-action="Login" class="nav-link me-3">
                                <i class="ri-login-box-line ri-lg me-1"></i>
                                <span class="d-none d-lg-inline">Login</span>
                            </a>
                            <a asp-controller="Account" asp-action="SignUp" class="nav-link me-3">
                                <i class="ri-user-add-line ri-lg me-1"></i>
                                <span class="d-none d-lg-inline">Sign Up</span>
                            </a>
                        </div>
                    }

                    <!-- Cart Icon - Always visible -->
                    <a asp-controller="Cart" asp-action="Index" class="nav-link position-relative">
                        <i class="ri-shopping-cart-2-line ri-lg"></i>
                        <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-primary">
                            0
                        </span>
                    </a>

                    <!-- Search Icon -->
                    <a href="#" class="nav-link ms-3" data-bs-toggle="modal" data-bs-target="#searchModal">
                        <i class="ri-search-line ri-lg"></i>
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Search Modal -->
    <div class="modal fade" id="searchModal" tabindex="-1" aria-labelledby="searchModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body">
                    <button type="button" class="btn-close float-end" data-bs-dismiss="modal" aria-label="Close" style="color: #b87d35"></button>
                    <h5 class="modal-title mb-3" id="searchModalLabel">Search Products</h5>
                    <form action="#" method="get">
                        <div class="input-group">
                            <input type="text" class="form-control" placeholder="Search for products...">
                            <button class="btn btn-primary" type="submit">
                                <i class="ri-search-line"></i>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main>
        @RenderBody()
    </main>

    <!-- Footer -->
    <footer class="footer-bg text-white pt-5 pb-3">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-4">
                    <h5 class="mb-4">Tagerly</h5>
                    <p>A store specializing in unique handmade products made with love and care.</p>
                    <div class="social-icons mt-4">
                        <a href="#" class="text-white me-3"><i class="ri-facebook-fill ri-lg"></i></a>
                        <a href="#" class="text-white me-3"><i class="ri-instagram-line ri-lg"></i></a>
                        <a href="#" class="text-white me-3"><i class="ri-twitter-fill ri-lg"></i></a>
                    </div>
                </div>
                <div class="col-md-2 mb-4">
                    <h5 class="mb-4">Quick Links</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="#" class="text-white-50">Home</a></li>
                        <li class="mb-2"><a href="#" class="text-white-50">About Us</a></li>
                        <li class="mb-2"><a href="/Products" class="text-white-50">Products</a></li>
                        <li class="mb-2"><a href="#" class="text-white-50">Blog</a></li>
                    </ul>
                </div>
                <div class="col-md-3 mb-4">
                    <h5 class="mb-4">Customer Service</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="#" class="text-white-50">Contact</a></li>
                        <li class="mb-2"><a href="#" class="text-white-50">FAQs</a></li>
                        <li class="mb-2"><a href="#" class="text-white-50">Return Policy</a></li>
                        <li class="mb-2"><a href="#" class="text-white-50">Privacy Policy</a></li>
                    </ul>
                </div>
                <div class="col-md-3 mb-4">
                    <h5 class="mb-4">Newsletter</h5>
                    <p>Subscribe to get updates on our latest offers and products.</p>
                    <form class="mt-3">
                        <div class="input-group">
                            <input type="email" class="form-control" placeholder="Your email">
                            <button class="btn btn-primary" type="submit">Subscribe</button>
                        </div>
                    </form>
                </div>
            </div>
            <hr class="my-4 bg-secondary">
            <div class="row">
                <div class="col-md-6 text-center text-md-start">
                    <p class="mb-0">© 2023 Tagerly. All rights reserved.</p>
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <img src="~/assets/images/payment/paypal.png" alt="Payment Methods" height="30">
                </div>
            </div>
        </div>
    </footer>
    <script src="~/assets/js/theme.bundle.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Or if using a local copy or via a package manager -->
    <script src="~/lib/jquery/dist/jquery.min.js"></script>

    <script>
        // Auto-dismiss notifications after 5 seconds
        document.addEventListener('DOMContentLoaded', function () {
            const notifications = document.querySelectorAll('.alert-notification');

            notifications.forEach(notification => {
                // Start dismiss timeout
                const dismissTimer = setTimeout(() => {
                    notification.classList.remove('show');
                    notification.addEventListener('transitionend', () => {
                        notification.remove();
                    }, { once: true });
                }, 5000);

                // Pause on hover
                notification.addEventListener('mouseenter', () => {
                    clearTimeout(dismissTimer);
                });

                // Resume on mouse leave
                notification.addEventListener('mouseleave', () => {
                    setTimeout(() => {
                        notification.classList.remove('show');
                        notification.addEventListener('transitionend', () => {
                            notification.remove();
                        }, { once: true });
                    }, 2000);
                });

                // Manual close
                notification.querySelector('.btn-close').addEventListener('click', () => {
                    clearTimeout(dismissTimer);
                    notification.classList.remove('show');
                    notification.addEventListener('transitionend', () => {
                        notification.remove();
                    }, { once: true });
                });
            });
        });
    </script>

    @await RenderSectionAsync("Scripts", required: false)
</body>

</html>