@* 
@{
    ViewData["Title"] = "Users";
}

<h1>Users</h1> *@
@model List<UserViewModel>
@{
    ViewData["Title"] = "Manage Users";
    var uniqueRoles = Model.Select(u => u.Role).Distinct().ToList();
}

<style>
    :root {
        --wood-dark: #5E3023;
        --wood-medium: #895737;
        --wood-light: #B88B4A;
        --cream: #E3DCCB;
        --beige: #D8C4A7;
        --light-bg: #F5F1EB;
    }

    body {
        background-color: var(--light-bg);
        font-family: 'Cairo', sans-serif;
    }

    .table-container {
        background-color: var(--cream);
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        max-width: 1100px;
        margin: 40px auto;
    }

    h2 {
        color: var(--wood-dark);
        margin-bottom: 20px;
    }

    .filters {
        display: flex;
        gap: 20px;
        margin-bottom: 15px;
        flex-wrap: wrap;
    }

        .filters input, .filters select {
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-size: 1rem;
        }

    .table thead {
        background-color: var(--wood-medium);
        color: #fff;
    }

    .table tbody tr {
        background-color: #fff;
        transition: background 0.3s;
    }

        .table tbody tr:hover {
            background-color: var(--light-bg);
        }

    .btn {
        font-size: 0.9rem;
    }

    .status-active {
        color: green;
        font-weight: bold;
    }

    .status-inactive {
        color: red;
        font-weight: bold;
    }
</style>

<div class="table-container">
    <h2>Users Management</h2>

    <div class="filters">
        <input type="text" id="searchInput" placeholder="Search by email..." onkeyup="filterTable()" />
        <select id="roleFilter" onchange="filterTable()">
            <option value="">All Roles</option>
            @foreach (var role in uniqueRoles)
            {
                <option value="@role">@role</option>
            }
        </select>
    </div>

    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Email</th>
                <th>Role</th>
                <th>Status</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="userTable">
            @foreach (var user in Model)
            {
                <tr>
                    <td>@user.Email</td>
                    <td>@user.Role</td>
                    <td>
                        @if (user.IsActive)
                        {
                            <span class="status-active">Active</span>
                        }
                        else
                        {
                            <span class="status-inactive">Deactivated</span>
                        }
                    </td>
                    <td>
                        <form asp-action="ToggleActivation" method="post">
                            <input type="hidden" name="id" value="@user.Id" />
                            <button type="submit" class="btn btn-sm @(user.IsActive ? "btn-danger" : "btn-success")">
                                @(user.IsActive ? "Deactivate" : "Activate")
                            </button>
                        </form>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>

@section Scripts {
    <script>
        function filterTable() {
            const search = document.getElementById("searchInput").value.toLowerCase();
            const roleFilter = document.getElementById("roleFilter").value.toLowerCase();
            const rows = document.querySelectorAll("#userTable tr");

            rows.forEach(row => {
                const email = row.cells[0].innerText.toLowerCase();
                const role = row.cells[1].innerText.toLowerCase();

                const emailMatch = email.includes(search);
                const roleMatch = !roleFilter || role === roleFilter;

                row.style.display = (emailMatch && roleMatch) ? "" : "none";
            });
        }
    </script>
}


